<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Tools – Africa CDC Database</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-database.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-b1a009cd478e574395e6b462a577de8f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e8e7b20115c09b9c89e8d8230fb99f5e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-tools.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tools</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Africa CDC Database</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/ecohealthalliance/acdc-db-handbook/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Africa-CDC-Database.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Africa-CDC-Database.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-tools.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tools</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Database</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sources</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-updates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Updates</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Survey</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-airtable" id="toc-sec-airtable" class="nav-link active" data-scroll-target="#sec-airtable"><span class="header-section-number">2.1</span> Airtable</a>
  <ul class="collapse">
  <li><a href="#what-is-airtable" id="toc-what-is-airtable" class="nav-link" data-scroll-target="#what-is-airtable"><span class="header-section-number">2.1.1</span> What is Airtable?</a></li>
  <li><a href="#key-terms" id="toc-key-terms" class="nav-link" data-scroll-target="#key-terms"><span class="header-section-number">2.1.2</span> Key Terms</a></li>
  <li><a href="#security-and-access-control" id="toc-security-and-access-control" class="nav-link" data-scroll-target="#security-and-access-control"><span class="header-section-number">2.1.3</span> Security and Access Control</a></li>
  <li><a href="#data-in-airtable" id="toc-data-in-airtable" class="nav-link" data-scroll-target="#data-in-airtable"><span class="header-section-number">2.1.4</span> Data in Airtable</a></li>
  <li><a href="#views" id="toc-views" class="nav-link" data-scroll-target="#views"><span class="header-section-number">2.1.5</span> Views</a></li>
  <li><a href="#internal-backups-record-history-base-snapshots" id="toc-internal-backups-record-history-base-snapshots" class="nav-link" data-scroll-target="#internal-backups-record-history-base-snapshots"><span class="header-section-number">2.1.6</span> Internal Backups: Record History, Base Snapshots</a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data"><span class="header-section-number">2.1.7</span> Importing data</a></li>
  </ul></li>
  <li><a href="#base-design" id="toc-base-design" class="nav-link" data-scroll-target="#base-design"><span class="header-section-number">2.2</span> Base Design</a></li>
  <li><a href="#automating-airtable" id="toc-automating-airtable" class="nav-link" data-scroll-target="#automating-airtable"><span class="header-section-number">2.3</span> Automating Airtable</a>
  <ul class="collapse">
  <li><a href="#automations-with-drag-and-drop-programing-pro-and-above" id="toc-automations-with-drag-and-drop-programing-pro-and-above" class="nav-link" data-scroll-target="#automations-with-drag-and-drop-programing-pro-and-above"><span class="header-section-number">2.3.1</span> Automations with Drag and Drop Programing (pro and above)</a></li>
  <li><a href="#scripting-and-blocks-pro-plan-and-above" id="toc-scripting-and-blocks-pro-plan-and-above" class="nav-link" data-scroll-target="#scripting-and-blocks-pro-plan-and-above"><span class="header-section-number">2.3.2</span> Scripting and Blocks (pro plan and above)</a></li>
  </ul></li>
  <li><a href="#using-the-rest-api" id="toc-using-the-rest-api" class="nav-link" data-scroll-target="#using-the-rest-api"><span class="header-section-number">2.4</span> Using the REST API</a>
  <ul class="collapse">
  <li><a href="#scoped-tokens" id="toc-scoped-tokens" class="nav-link" data-scroll-target="#scoped-tokens"><span class="header-section-number">2.4.1</span> Scoped Tokens</a></li>
  <li><a href="#airtable-and-r" id="toc-airtable-and-r" class="nav-link" data-scroll-target="#airtable-and-r"><span class="header-section-number">2.4.2</span> Airtable and R</a></li>
  </ul></li>
  <li><a href="#data-management" id="toc-data-management" class="nav-link" data-scroll-target="#data-management"><span class="header-section-number">2.5</span> Data Management</a>
  <ul class="collapse">
  <li><a href="#metadata" id="toc-metadata" class="nav-link" data-scroll-target="#metadata"><span class="header-section-number">2.5.1</span> Metadata</a></li>
  <li><a href="#external-backups" id="toc-external-backups" class="nav-link" data-scroll-target="#external-backups"><span class="header-section-number">2.5.2</span> External Backups</a></li>
  </ul></li>
  <li><a href="#r" id="toc-r" class="nav-link" data-scroll-target="#r"><span class="header-section-number">2.6</span> R</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ecohealthalliance/acdc-db-handbook/edit/main/01-tools.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-tools" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tools</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The Africa CDC Database is currently using the following set of tools for database development and maintenance.</p>
<section id="sec-airtable" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sec-airtable"><span class="header-section-number">2.1</span> Airtable</h2>
<section id="what-is-airtable" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="what-is-airtable"><span class="header-section-number">2.1.1</span> What is Airtable?</h3>
<p><a href="https://airtable.com">Airtable</a> is a cloud-based software platform that allows users to create and manage databases, spreadsheets, and other types of organizational tools. It can be used for a variety of purposes, including project management, customer relationship management, inventory tracking, event planning, and much more.</p>
<p>One of the key features of Airtable is its flexible and customizable nature. Users can create and customize their own database structures, and can choose from a wide range of data types, including text, attachments, checkboxes, and more. This allows for a high degree of customization and adaptability to different use cases and workflows.</p>
<p>Airtable also offers a variety of collaboration features, including real-time syncing and commenting, as well as integrations with other popular tools such as Slack, Google Drive, and Trello. Additionally, Airtable has a robust API that allows developers to build custom integrations and applications on top of the platform.</p>
<p>Airtable’s flexibility, customizability, and features that support collaboration along with its spreadsheet-style interface that is familiar to most that have used other spreadsheet software such as Microsoft Excel or Google Sheets are the key reasons why it was chosen to be the database tool for RIG.</p>
<p><a href="#sec-airtable" class="quarto-xref"><span>Section 2.1</span></a> provides an overview of Airtable and good practices for designing data models in relational databases.</p>
</section>
<section id="key-terms" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="key-terms"><span class="header-section-number">2.1.2</span> Key Terms</h3>
<ul>
<li><strong>Workspace</strong> - A collection of bases</li>
<li><strong>Base</strong> - A database. Each is identified by the Airtable API via a <code>base id</code></li>
<li><strong>Table</strong> - A tabular data set within a base. Each table is identified by the Airtable API via the name of the table e.g.&nbsp;“Demo Table”</li>
<li><strong>Record</strong> - An individual cell within a table. Each record is identified by the Airtable API via a <code>record id</code></li>
<li><strong>Field</strong> - A property of data in a table</li>
<li><strong>Views</strong> - A specific way of displaying a table. Default is grid.</li>
<li><strong>Entity</strong> - Something that either physically or logically exists whose properties are typically stored in a table and composed of data elements.</li>
<li><strong>Element</strong> - an attribute of a Entity (a field)</li>
</ul>
</section>
<section id="security-and-access-control" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="security-and-access-control"><span class="header-section-number">2.1.3</span> Security and Access Control</h3>
<p>Airtable maintains physical and technological security as part of its ISO IEC 27001:2013 and SOC 2 compliance measures. Data are 256-bit encrypted when storing on the server and also when transferring data over the internet. To find vulnerabilities in their software, they run daily, weekly, and monthly scans on different components of their system and regularly commission external penetration tests. They also run a bug bounty program to help identify issues. Their data centers have fire detection and suppression systems, redundant power systems, and strict control for physical access. Because Airtable relies on Amazon Web Services (AWS) for its cloud infrastructure (the same providers used by previous EHA projects), data are geo-redundantly replicated in backups across multiple zones to increase data durability. They also have a team monitoring services at all times. Airtable employees are thoroughly vetted before hiring and continually trained on data protection best practices. Their workstations are secured by using full-disk encryption, automatic locking, and strong password requirements.</p>
<section id="user--and-administrator-security-features" class="level4" data-number="2.1.3.1">
<h4 data-number="2.1.3.1" class="anchored" data-anchor-id="user--and-administrator-security-features"><span class="header-section-number">2.1.3.1</span> User- and Administrator Security Features</h4>
<section id="access-controls" class="level5" data-number="2.1.3.1.1">
<h5 data-number="2.1.3.1.1" class="anchored" data-anchor-id="access-controls"><span class="header-section-number">2.1.3.1.1</span> Access Controls</h5>
<p>Airtable provides database (referred to as “base”) and workspace administrators with granular controls over who can view, edit, comment, or otherwise modify data at the base, table, and field levels. There are four levels of Airtable user permissions:</p>
<ul>
<li><strong>Owner/Creator</strong>: Full administrative control of base<br>
</li>
<li><strong>Editor</strong>: Sees full base, create and modify records and views, create and modify view share links<br>
</li>
<li><strong>Commenter</strong>: Sees full base, comment on records<br>
</li>
<li><strong>Reader</strong>: Sees full base</li>
</ul>
<p>Direct access to a base or workspace is granted or removed by base owners and creators to Airtable users. Base owners and creators can control who has access to a base and can control any “share” links created for that base. They may also restrict editing of tables or fields within a base. Any collaborator given direct access to a base at any permission level will be able to duplicate that base and share that data further. It is important that direct access to the base is limited to individuals with a need to curate or analyze the data.</p>
</section>
<section id="share-links-and-interfaces" class="level5" data-number="2.1.3.1.2">
<h5 data-number="2.1.3.1.2" class="anchored" data-anchor-id="share-links-and-interfaces"><span class="header-section-number">2.1.3.1.2</span> Share Links and Interfaces</h5>
<p>To further restrict access to a base, users can be given indirect access via revocable share links or interfaces.</p>
<p><a href="https://support.airtable.com/docs/creating-a-base-share-link-or-a-view-share-link">Share links</a> can be customized to prevent users from seeing the full base, prevent duplicating the base, and prevent copying data from the base. The ability to use the link can be password protected, restricted to people with certain email domains, and may be revoked at any time. If there are concerns about data leaks via base or table duplication, inviting people with a need to view the data via share links constrains their ability to extract data from the base.</p>
<p><a href="https://support.airtable.com/docs/interface-designer-overview">Interfaces</a> are dynamic dashboards built on a limited set of data in an airtable base. Users can explore or even edit data based on the permissions provided by the interface creator. Access can be further tuned by setting up a “current-user filter”. See <a href="https://support.airtable.com/docs/interface-designer-permissions">this guide</a> for more information.</p>
</section>
</section>
</section>
<section id="data-in-airtable" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="data-in-airtable"><span class="header-section-number">2.1.4</span> Data in Airtable</h3>
<p>See <a href="https://support.airtable.com/hc/en-us/articles/115010928147-Airtable-plans">Airtable plan comparison</a> for more information on the size of bases and features available. Information in this section pertains to all plans unless specified.</p>
<section id="workspaces-bases-tables-fields-records" class="level4" data-number="2.1.4.1">
<h4 data-number="2.1.4.1" class="anchored" data-anchor-id="workspaces-bases-tables-fields-records"><span class="header-section-number">2.1.4.1</span> Workspaces, Bases, Tables, Fields, Records</h4>
<p>Airtable uses workspaces, bases, tables, and fields to manage data. A workspace generally pertains to a particular project and contains all bases relevant to that project. Sharing a workspace with someone allows them to see all bases within that workspace.</p>
<p>Bases are equivalent to databases. They consist of a set of tables that can be linked and allow you to perform some task (e.g.&nbsp;IRB tracking, capturing research data, etc.). Bases can be duplicated and shared across your workspaces and you can share bases with other users.</p>
<p>Tables are where most of the action happens. Data is entered in tables, tables can be transformed via views into calendars, dashboards, or galleries, and tables can be manipulated via the API. They describe a data entity and are composed of fields. In the bat sampling example, each circle would be a table in the bat sampling base.</p>
<p>Fields represent properties of a data entity. In a spreadsheet view, fields are columns. Airtable allows you to control field types (date, number, text, file attachments, logical, etc.) and paid plans allows you to control who can edit fields. Fields can be linked between tables creating links.</p>
<p>Records are the individual data points in a table. In a spreadsheet they would be the rows. Records are shaped by the structure you have created in tables and fields. Each record has a URL that can be used to access it programatically or share it.</p>
</section>
</section>
<section id="views" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="views"><span class="header-section-number">2.1.5</span> Views</h3>
<p>In Airtable, tables can be displayed in different views to emphasis different components of the data. Views are great for creating concise presentations of data, especially in sprawling tables. The default view in an table is the grid (spreadsheet) view. All other views will derive from the data entered in this view.</p>
<p>For more on views, see <a href="https://support.airtable.com/hc/en-us/articles/202624989-Guide-to-views">the guide to views</a>.</p>
</section>
<section id="internal-backups-record-history-base-snapshots" class="level3" data-number="2.1.6">
<h3 data-number="2.1.6" class="anchored" data-anchor-id="internal-backups-record-history-base-snapshots"><span class="header-section-number">2.1.6</span> Internal Backups: Record History, Base Snapshots</h3>
<p>Airtable has system for tracking changes to a base. They provide revision history for individual records (how long those histories are stored varies by plan). Any comments made in the revision history will be stored for the life of the record (on any plan). The current state of an entire base may be captured through snapshots. Should a systemic issue arise, the base can be restored to a snapshot at a later date. Restoring from a snapshot will remove the revision history for a record but comments on that record will be maintained.</p>
<p>As revision histories are maintained, “deleted” records may be retrieved. In the event of the need to permanently remove data, the revision history of the base may be removed.</p>
<p>Airtable allows data to be exported as CSVs from individual tables. At this time there is not an Airtable supported base export function.</p>
</section>
<section id="importing-data" class="level3" data-number="2.1.7">
<h3 data-number="2.1.7" class="anchored" data-anchor-id="importing-data"><span class="header-section-number">2.1.7</span> Importing data</h3>
<p>Data can be imported to Airtable from a number of sources including CSV files, excel, Google sheets, XML, and via copy paste. Airtable will guess what the most appropriate field type is, so make sure the field type is appropriate for the data (e.g.&nbsp;convert from text to date type fields). Certain sources, like Google sheets, can be imported as bases.</p>
<p>For more on importing data see: <a href="https://support.airtable.com/hc/en-us/sections/200928025-Importing-and-adding-data">Importing and Adding data</a></p>
</section>
</section>
<section id="base-design" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="base-design"><span class="header-section-number">2.2</span> Base Design</h2>
<p>Having a good base design will make using your data easier. Generally, the process looks like this:</p>
<ol start="0" type="1">
<li>Describe what the database will do and collect use cases</li>
<li>Determine the roles of various stakeholders</li>
<li>List out the entities in the database and define their properties</li>
<li>Map out how the entities fit together (which properties link them)</li>
<li>Check that the mapping meets the use cases</li>
<li>Build base in Airtable</li>
<li>Check that the base meets the use cases</li>
</ol>
<p>If you are migrating from spreadsheets, you likely already have an idea of what you need the base to do and a collection of data properties. It is still a good idea to follow the steps outlined above for mapping out entities. You may find that entire sheets can be replaced by views or that the data in one sheet should actually be stored in two different tables.</p>
<p>Feel free to reach out to the data librarian for questions about base design.</p>
</section>
<section id="automating-airtable" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="automating-airtable"><span class="header-section-number">2.3</span> Automating Airtable</h2>
<p>Airtable has five main routes for automating processes.</p>
<ol type="1">
<li><a href="https://support.airtable.com/hc/en-us/articles/360050974153-Automations-overview">Automations</a> - a drag and drop visual programming tool</li>
<li><a href="https://support.airtable.com/docs/airtable-extensions-overview">Extensions</a> - pre-built applications that perform some task</li>
<li><a href="https://support.airtable.com/hc/en-us/articles/360043041074-Scripting-app-overview">Scripting</a> - use JavaScript to automate tasks within Airtable</li>
<li><a href="https://www.airtable.com/developers/apps/guides/getting-started">Blocks</a> - use JavaScript to create custom applications</li>
<li><a href="https://airtable.com/api">REST API</a> - use whatever programming language you like to automate processes</li>
</ol>
<section id="automations-with-drag-and-drop-programing-pro-and-above" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="automations-with-drag-and-drop-programing-pro-and-above"><span class="header-section-number">2.3.1</span> Automations with Drag and Drop Programing (pro and above)</h3>
<p>The automations feature within Airtable allows you to visually program routines. Each automation has three basic components:</p>
<ul>
<li>Status - controls whether or not the automation will run when the trigger condition is met</li>
<li>Triggers - condition for automation to run: the creation or change of a record, a scheduled time, or some other external action</li>
<li>Actions - what the automation will do</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-tools_files/figure-html/actions diagram-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Automations are commonly used to augment the synced tables feature, send notifications, check data quality, and manipulate or create records.</p>
<p>This automation creates a weekly summary of applicants who applied for a position. Its trigger is time based, then it finds records that match a condition, and finally it generates an email from those records and sends to the appropriate recipients.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/airtable_Weekly Digest.png" class="img-fluid figure-img"></p>
<figcaption>airtable weekly summary</figcaption>
</figure>
</div>
</section>
<section id="scripting-and-blocks-pro-plan-and-above" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="scripting-and-blocks-pro-plan-and-above"><span class="header-section-number">2.3.2</span> Scripting and Blocks (pro plan and above)</h3>
<p>Scripting uses JavaScript to manipulate a base from within an application in Airtable. Scripting is flexible but has a steep learning curve. The scripting environment Airtable provides can be helpful as it provides code <a href="https://en.wikipedia.org/wiki/Lint_(software)">linting</a>, direct access to documentation, and example scripts to build from. The major drawback to scripting is that scripts live in the base and files are not version controlled.</p>
<ul>
<li>There are a LOT of <a href="https://airtable.com/marketplace/category/scripts">pre-written scripts, in a shared “marketplace”</a> to perform automatic actions. Search the marketplace before you start writing bespoke code.</li>
</ul>
<p>Blocks are custom applications built in JavaScript and node.js that add to base functionality. They are created in a development environment outside of Airtable then brought back into platform. There are number of <a href="https://www.airtable.com/developers/apps/guides/getting-started">tutorials for getting started with blocks</a>.</p>
</section>
</section>
<section id="using-the-rest-api" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="using-the-rest-api"><span class="header-section-number">2.4</span> Using the REST API</h2>
<p>All Airtable bases are automatically accessible to authorized users via a REST API. The list of API accessible bases you have access to can be found here: https://airtable.com/api. By clicking on a base you will be able to see the full API documentation for that base.</p>
<section id="scoped-tokens" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="scoped-tokens"><span class="header-section-number">2.4.1</span> Scoped Tokens</h3>
<p>Airtable is moving to a <a href="https://airtable.com/developers/web/guides/personal-access-tokens">scoped tokens</a> based approach to api access. Scoped personal access tokens allow you to create a token for a specific base with specific permissions - e.g.&nbsp;token has read-only access to a bat sampling base. Using scoped tokens in this way means that if the token is compromised (leaked, stolen, accidentally committed unencrypted to a github repo, etc), you can delete that token to remove any access it might have had and the limited scope means that you know exactly what a person would have been able to access.</p>
<p>To create a personal access token go here: https://airtable.com/create/tokens</p>
<p>** Remember to save the token in a secure place. Do not store unencrypted tokens on the web (e.g.&nbsp;pushing them to github).</p>
<p>Airtable has also deployed <a href="https://airtable.com/developers/web/api/oauth-reference">oauth tokens</a> for all users.</p>
</section>
<section id="airtable-and-r" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="airtable-and-r"><span class="header-section-number">2.4.2</span> Airtable and R</h3>
<p>The Airtable REST API can be used via R with the <a href="https://github.com/ecohealthalliance/airtabler">airtabler package</a>. EHA has started a fork of the package that has additional functionality so it is recommended to use that version. The original package design works well for exploring the data. Our extension adds additional functionality to help use <code>airtabler</code> in automation via continuous integration such as GitHub Actions.</p>
<pre><code>devtools::install_github("ecohealthalliance/airtabler")</code></pre>
<p>The Airtable API serves up data as JSON, which has a hierarchical structure similar to a list in R. To handle JSON, <code>airtabler</code> uses the <code>jsonlite</code> package. Its helpful to understand how <code>jsonlite</code> handles different JSON structures when working with more complicated Airtable data. See the <code>jsonlite</code> <a href="https://cran.r-project.org/web/packages/jsonlite/vignettes/json-aaquickstart.html">quick-start guide</a> for a basic overview. The <a href="https://purrr.tidyverse.org/"><code>purr</code> package</a> is extremely helpful when dealing with data objects derived from JSON because it facilitates navigating nested data structures.</p>
<p>The <code>airtabler</code> package provides instructions for setting up access to the Airtable API. You will need to follow those instructions for the following examples to work.</p>
<p><strong>One to One join</strong></p>
<pre><code>library(airtabler)

table1  &lt;-  fetch_all(base = "app49bbyLczZxX9PM",table_name = "One To One")

table2 &lt;- fetch_all(base = "app49bbyLczZxX9PM",table_name = "Table 2")

## Linked records are stored as JSON arrays so they become lists 
## when part of a data frame. Because each array has a length of 1
## we can safely unlist the arrays and add them back as to the 
## data frame.

table1$LinkedRec &lt;- unlist(table1$LinkedRec)

joinedTables &lt;- dplyr::left_join(table1,table2, by = c("LinkedRec"="id"))

recordKey &lt;- joinedTables[c("Name","LinkedRec","Number")]

recordKey

</code></pre>
<p><strong>One to Many Join</strong></p>
<pre><code>library(airtabler)
library(dplyr)
library(purrr)

oneToMany  &lt;-  fetch_all(base = "app49bbyLczZxX9PM",table_name = "One To Many")

table2 &lt;- fetch_all(base = "app49bbyLczZxX9PM",table_name = "Table 2")

# Depending on how you want to work with the data joins are a 
# little trickier here. 

## to replace the values but keep the structure

oneToMany$LinkedRecReplace &lt;- purrr::map(oneToMany$LinkedRec, function(x){
  table2 %&gt;%
    filter(id %in% x) %&gt;%
    select(c("id","Number")) %&gt;% 
    pull("Number")
})

data.frame(
  id = unlist(oneToMany$LinkedRec), 
  label = unlist(oneToMany$LinkedRecReplace)
)
</code></pre>
</section>
</section>
<section id="data-management" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="data-management"><span class="header-section-number">2.5</span> Data Management</h2>
<p>Because of its flexibility and ease of use, it is extremely important that data management for airtable be taken seriously. Unlike most other relational databases, the fundamental properties of your base can be changed easily by multiple users without warning! Documenting the structure and purpose of your base, as well as creating regular external backups could save you from catastrophe.</p>
<section id="metadata" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="metadata"><span class="header-section-number">2.5.1</span> Metadata</h3>
<ul>
<li><strong>Structural metadata</strong> - Information about a resource that tells you how its put together - e.g.&nbsp;the relationship between a table, field, and automation. With the exception of users on the enterprise plan, you must be deliberate about creating and maintaining structural metadata for your base.</li>
</ul>
<p>Example of Airtable Structural Metadata: <iframe class="airtable-embed" src="https://airtable.com/embed/shrsv0CWMSERgUIR8?backgroundColor=gray&amp;viewControls=on" frameborder="0" onmousewheel="" width="100%" height="533" style="background: transparent; border: 1px solid #ccc;"></iframe></p>
<ul>
<li><strong>Descriptive metadata</strong> - Information about a resource that makes it easier to find and attribute data. This includes things attributes like author, title, description, keywords, etc. This table becomes especially important when data are transitioned out of airtable, at the end of a project, or if the base will be shared broadly with collaborators.</li>
</ul>
<p>Example of Airtable Descriptive Metadata: <iframe class="airtable-embed" src="https://airtable.com/embed/shrFr7eafWtH4s7ll?backgroundColor=gray&amp;viewControls=on" frameborder="0" onmousewheel="" width="100%" height="533" style="background: transparent; border: 1px solid #ccc;"></iframe></p>
<p>To see the template base, follow this <a href="https://airtable.com/invite/l?inviteId=inv5ycCAbIVw1WM3Z&amp;inviteToken=ef7b72e998a0a69d835244f87f88b6b9b6b1094915239ebc93423e1257fcd72b&amp;utm_medium=email&amp;utm_source=product_team&amp;utm_content=transactional-alerts">link</a></p>
<section id="metadata-for-automations-and-extensions" class="level4" data-number="2.5.1.1">
<h4 data-number="2.5.1.1" class="anchored" data-anchor-id="metadata-for-automations-and-extensions"><span class="header-section-number">2.5.1.1</span> Metadata for automations and extensions</h4>
<p>Automations and extensions live entirely inside airtable. As of August 2022, Airtable introduced a “Manage Fields” tab that provides metadata for a specific table, including any automation dependencies. It is not possible to export those dependency tables or the code used in automations automatically. This makes it extremely important to document any automations and extensions outside your base.</p>
</section>
</section>
<section id="external-backups" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="external-backups"><span class="header-section-number">2.5.2</span> External Backups</h3>
<p>It is a good idea to create regular external backups of airtable data in the event that something catastrophic happens to your base or you simply decide you no longer wish to use airtable as your data store.Unfortunately, airtable does not provide an off the shelf solution for this. Below are three options for extracting all data from your base.</p>
<section id="using-airtabler" class="level4" data-number="2.5.2.1">
<h4 data-number="2.5.2.1" class="anchored" data-anchor-id="using-airtabler"><span class="header-section-number">2.5.2.1</span> Using airtabler</h4>
<p>Using <code>airtabler::air_dump()</code> and <code>airtabler::air_dump_to_csv()</code> functions, you can export all tables to R then create a versioned folder of CSVs. See the <code>air_dump_to_csv</code> help page for more information.</p>
</section>
<section id="other-open-source-projects" class="level4" data-number="2.5.2.2">
<h4 data-number="2.5.2.2" class="anchored" data-anchor-id="other-open-source-projects"><span class="header-section-number">2.5.2.2</span> Other Open Source Projects</h4>
<p>UnlyEd - use this template to push airtable backups to AWS S3.</p>
<ul>
<li>https://github.com/UnlyEd/airtable-backups-boilerplate</li>
</ul>
</section>
<section id="paid-services" class="level4" data-number="2.5.2.3">
<h4 data-number="2.5.2.3" class="anchored" data-anchor-id="paid-services"><span class="header-section-number">2.5.2.3</span> Paid services</h4>
<p>Sequin - replicate airtable to postGres database - https://www.sequin.io/sources/airtable</p>
</section>
</section>
</section>
<section id="r" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="r"><span class="header-section-number">2.6</span> R</h2>
<p><a href="https://cran.r-project.org">R</a> is a free and open-source programming language and software environment for statistical computing and graphics. It was first developed in the early 1990s by Ross Ihaka and Robert Gentleman at the University of Auckland, New Zealand, and is now widely used by statisticians, data analysts, and researchers across various fields.</p>
<p>R provides a wide range of statistical and graphical techniques, including linear and nonlinear modeling, classical statistical tests, time-series analysis, classification, clustering, and more. It also has a large and active community of users and developers who contribute to the development of new packages and extensions for the language.</p>
<p>R is popular in the field of data science, as it provides a powerful and flexible platform for analyzing and visualizing data. It can be used in conjuction with other tools such as Airtable through community-developed packages making it particularly well-suited for the current use-case of the RIG.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-database.html" class="pagination-link" aria-label="Database">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Database</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ecohealthalliance/acdc-db-handbook/edit/main/01-tools.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>